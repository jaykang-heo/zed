# PR #45073: cli: Use Terminal Panel's window for `zed --add`

_Merged: 2026-02-12T10:55:56Z_
_PR: https://github.com/zed-industries/zed/pull/45073_

Now I have enough context to analyze the changes. Let me review what the code changes do:

## Analysis of Code Changes

The diff shows changes to window selection behavior when opening files via the CLI with the `--add` flag:

1. **workspace.rs**: Modified the condition that determines if files should open in the focused window. Now it also considers the case when `open_new_workspace == Some(false)` AND `prefer_focused_window` is true.

2. **open_listener.rs**: Changed the logic so that when `--add` is used (`open_new_workspace == Some(false)`), it sets `prefer_focused_window` to `true`.

3. **Test added**: A comprehensive test verifies that the `--add` flag now correctly opens files in the focused window when multiple windows are open.

**What this changes**: Previously, using `zed --add file.txt` with multiple windows open could open the file in an arbitrary window. Now it **consistently opens in the focused window**.

This is a **behavior change** to an existing CLI flag that affects user-facing functionality and should be documented.

## Documentation Suggestions

### Summary
The `--add` flag behavior changed to consistently open files in the focused window when multiple workspace windows are open, rather than potentially opening in an arbitrary window.

### Suggested Changes

#### 1. [docs/src/reference/cli.md]
- **Section**: "Options" → "-a, --add" subsection
- **Change**: Update
- **Target keyword**: zed cli add flag
- **Frontmatter**:
  ```yaml
  ---
  title: CLI Reference
  description: "Reference for Zed's command-line interface (CLI), including opening files and directories, integrating with tools, and controlling Zed from scripts."
  ---
  ```
- **Links**: Already has good internal links (command palette, settings). Page is reference material, so no additional links needed.
- **Suggestion**: 

Current text:
```markdown
### `-a`, `--add`

Add paths to the currently focused workspace instead of opening a new window:

```sh
zed -a newfile.txt
```
```

Should become:
```markdown
### `-a`, `--add`

> **Changed in Preview (v0.225).** See [release notes](/releases#0.225).

Add paths to the currently focused workspace instead of opening a new window. When multiple workspace windows are open, files open in the focused window:

```sh
zed -a newfile.txt
```
```

- **Full-file brand pass**: Not required. The existing file already follows brand voice conventions (direct, present tense, second person, no hedging). The suggested addition maintains this voice.

- **Brand voice scorecard**:

  | Criterion            | Score | Notes |
  | -------------------- | ----- | ----- |
  | Technical Grounding  | 5/5   | Specific technical detail about window focus behavior |
  | Natural Syntax       | 5/5   | Simple sentence structure, clear subordinate clause |
  | Quiet Confidence     | 5/5   | States behavior directly without qualifiers |
  | Developer Respect    | 5/5   | Assumes reader knows what "focused window" means |
  | Information Priority | 5/5   | Behavior description comes first, example follows |
  | Specificity          | 5/5   | Precise about the multi-window scenario |
  | Voice Consistency    | 5/5   | Matches surrounding entries exactly |
  | Earned Claims        | 5/5   | No claims, just factual behavior description |
  | **TOTAL**            | 40/40 | Pass - all criteria meet threshold |

### Notes for Reviewer
This is a clarifying behavior change to an existing CLI flag. The change makes the `--add` flag more predictable when multiple windows are open, ensuring files open in the window the user is currently using. The documentation change is minimal—just one additional sentence—to match the direct style of the existing CLI reference.
