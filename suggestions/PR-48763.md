# PR #48763: repl: List python environments first

_Merged: 2026-02-12T07:20:20Z_
_PR: https://github.com/zed-industries/zed/pull/48763_

## Documentation Suggestions

### Summary
The REPL kernel picker has been redesigned to automatically detect Python environments without ipykernel installed, categorize kernels into grouped sections (Recommended, Python Environments, Jupyter Kernels, Remote Servers), and offer one-click ipykernel installation. This significantly changes the user flow for selecting and setting up kernels, warranting documentation updates to explain the new UX patterns.

### Suggested Changes

#### 1. docs/src/languages/repl.md
- **Section**: "Changing Kernels" (existing section to update)
- **Change**: Update
- **Target keyword**: "how to change REPL kernel in Zed"
- **Frontmatter**:
  ```yaml
  ---
  title: REPL
  description: Run code interactively in Zed with Jupyter kernels and Python environments
  ---
  ```
- **Links**: 
  - Internal: `[Python environments](/languages/python#environments)`, `[Jupyter kernels](#installing-jupyter-kernels)`, `[REPL settings](/configuration/settings#repl-settings)`
  - Marketing: `[Learn more about REPL in Zed](https://zed.dev/features/repl)` (place near the top of the page)
- **Suggestion**:

Replace the current "Changing Kernels" section with:

```markdown
## Changing Kernels

> **Preview:** This feature is available in Zed Preview. It will be included in the next Stable release.

The kernel picker shows available execution environments organized by type:

- **Recommended**: The Python environment matching your active toolchain (if detected)
- **Python Environments**: Virtual environments (venv, virtualenv, Poetry, Pipenv, Conda, uv, etc.)
- **Jupyter Kernels**: Installed Jupyter kernelspecs
- **Remote Servers**: Connected remote Jupyter servers

To switch kernels, click the kernel name in the Quick Action Bar or use {#kb repl::Sessions}.

### Installing ipykernel

Python environments appear in the picker even if ipykernel is not installed. Environments missing ipykernel are dimmed and labeled "ipykernel not installed." When you select one, Zed automatically runs `pip install ipykernel` in that environment and activates it once installation completes.

This allows you to use any Python environment detected by Zedâ€”no manual setup required.

### How Zed Recommends Kernels

When you run code, Zed selects a kernel automatically:

1. **Active toolchain match**: If a Python environment matches your [active toolchain](/languages/python#environments) and has ipykernel, Zed uses it
2. **First available Python env**: Otherwise, the first Python environment with ipykernel
3. **Language-based fallback**: If no Python envs are ready, Zed picks a Jupyter kernel matching the code block's language

You can override this by explicitly selecting a kernel from the picker.
```

- **Full-file brand pass**: Yes. The rest of `docs/src/languages/repl.md` should be reviewed for:
  - Removing any "simply" or "just" hedging language
  - Ensuring keybindings use `{#kb action::Name}` syntax consistently
  - Confirming second-person present tense throughout
  - Verifying at least 3 internal docs links total across the page
  - Ensuring the marketing link to `zed.dev/features/repl` is included near the top

- **Brand voice scorecard**:

  | Criterion            | Score | Notes |
  | -------------------- | ----- | ----- |
  | Technical Grounding  | 5     | Explicit technical details: pip install, ipykernel, toolchain matching |
  | Natural Syntax       | 5     | Direct second-person, no hedging, clear steps |
  | Quiet Confidence     | 5     | States facts without hype; "no manual setup required" is earned |
  | Developer Respect    | 5     | Assumes user understands envs; provides control to override |
  | Information Priority | 5     | Leads with what happens, not why it's great |
  | Specificity          | 5     | Names specific tools (venv, Poetry, Conda), exact commands |
  | Voice Consistency    | 5     | Matches existing Zed docs tone: factual, direct, user-focused |
  | Earned Claims        | 5     | "automatically" and "no manual setup" are backed by the code behavior |
  | **TOTAL**            | 40    | Passes threshold (all criteria 4+) |

### Notes for Reviewer
- The new auto-install flow is a significant UX improvement but may surprise users familiar with the old manual setup. The suggested docs emphasize the automatic behavior upfront.
- The "Recommended" section logic ties directly to the active toolchain detection, which should be cross-linked to Python environment docs if that section exists.
- Consider adding a troubleshooting subsection if users report issues with automatic ipykernel installation (e.g., permission errors, network failures). The current code shows toasts on failure but docs don't yet cover recovery steps.
