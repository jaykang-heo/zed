# PR #49139: Add agent worktree directory setting + worktree info persistence

_Merged: 2026-02-18T22:21:39Z_
_PR: https://github.com/zed-industries/zed/pull/49139_


## Documentation Suggestions

### Summary
This change adds a new `git.worktree_directory` setting that controls where git worktrees are created, with validation logic and persistence of worktree metadata in agent thread storage. Users need to know this setting exists, how to configure it, and what the path resolution behavior is.

### Suggested Changes

#### 1. docs/src/configuration/project-settings.md

- **Section**: Git Settings
- **Change**: Add
- **Target keyword**: git worktree directory configuration
- **Frontmatter**:
  ```yaml
  ---
  title: Project Settings
  description: Configure project-specific behavior including Git, LSP, tasks, and environment settings
  ---
  ```
- **Links**: 
  - [Git integration](/features/git)
  - [Settings reference](/reference/settings)
  - [Project search](/features/search#project-search)
  - https://zed.dev/features/git (marketing link)
- **Suggestion**: 

> **Preview:** This feature is available in Zed Preview. It will be included in the next Stable release.

Add the following entry to the Git Settings section:

**`git.worktree_directory`**

Directory where git worktrees are created, relative to the repository working directory.

When the resolved directory falls outside the project root, the project's directory name is automatically appended so that sibling repos don't collide. For example, with the default `"../worktrees"` and a project at `~/code/zed`, worktrees are created under `~/code/worktrees/zed/`.

When the resolved directory is inside the project root, no extra component is added (it's already project-scoped).

Examples:
- `"../worktrees"` — `~/code/worktrees/<project>/` (default)
- `".git/zed-worktrees"` — `<project>/.git/zed-worktrees/`
- `"my-worktrees"` — `<project>/my-worktrees/`

Trailing slashes are ignored.

Default: `"../worktrees"`

```json
{
  "git": {
    "worktree_directory": "../worktrees"
  }
}
```

- **Full-file brand pass**: Required: yes. Review the entire Git Settings section to ensure consistent voice (second person, present tense, no hedging words like "simply" or "just"). Verify all settings in that section follow the pattern of stating what the setting does, then showing valid values, without unnecessary preamble.

- **Brand voice scorecard**:

  | Criterion            | Score | Notes |
  | -------------------- | ----- | ----- |
  | Technical Grounding  | 5     | Specific path examples, clear resolution rules |
  | Natural Syntax       | 5     | Direct statements, no fluff |
  | Quiet Confidence     | 5     | No hedging, states behavior clearly |
  | Developer Respect    | 5     | Assumes reader understands paths and repos |
  | Information Priority | 5     | Behavior first, examples second |
  | Specificity          | 5     | Concrete paths, exact resolution logic |
  | Voice Consistency    | 5     | Matches Zed's technical style |
  | Earned Claims        | 5     | No marketing claims, just facts |
  | **TOTAL**            | 40/40 |       |

  Pass threshold: all criteria 4+. ✅

### Notes for Reviewer
The setting has validation logic that rejects absolute paths and paths that escape too far up the directory tree. The documentation focuses on valid usage patterns rather than enumerating failure cases, which matches Zed's approach of documenting the happy path. The automatic directory-name appending behavior for sibling directories is non-obvious and critical to document.
